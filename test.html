<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>服務測試 - 無障礙廁所GO V2</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .success { border-color: #4CAF50; background-color: #f1f8e9; }
        .error { border-color: #f44336; background-color: #ffebee; }
        .loading { border-color: #ff9800; background-color: #fff3e0; }
        .info { border-color: #2196F3; background-color: #e3f2fd; }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn-success { background: #4CAF50; color: white; }
        .btn-primary { background: #2196F3; color: white; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🔧 服務測試頁面</h1>
        <p>此頁面用於測試所有 JavaScript 服務是否正常載入和初始化。</p>
        
        <div id="test-results">
            <div class="test-item loading">
                <strong>⏳ 正在測試服務載入...</strong>
            </div>
        </div>
        
        <div style="margin-top: 20px;">
            <button class="btn-success" onclick="testServices()">🔄 重新測試</button>
            <button class="btn-primary" onclick="window.location.href='index.html'">🏠 回到首頁</button>
        </div>
    </div>

    <!-- 載入所有 JavaScript 檔案 -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/map.js"></script>
    <script src="js/accessibility.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/search.js"></script>
    <script src="js/main.js"></script>
    
    <script>
        // 測試服務載入
        function testServices() {
            const results = document.getElementById('test-results');
            results.innerHTML = '<div class="test-item loading"><strong>⏳ 正在測試服務載入...</strong></div>';
            
            setTimeout(() => {
                const tests = [
                    {
                        name: 'CONFIG 配置',
                        test: () => typeof window.CONFIG !== 'undefined'
                    },
                    {
                        name: 'Utils 工具',
                        test: () => typeof Utils !== 'undefined'
                    },
                    {
                        name: 'API 服務',
                        test: () => typeof window.APIService !== 'undefined'
                    },
                    {
                        name: 'AccessibilityService 無障礙服務',
                        test: () => typeof window.AccessibilityService !== 'undefined'
                    },
                    {
                        name: 'NavigationService 導航服務',
                        test: () => typeof window.NavigationService !== 'undefined'
                    },
                    {
                        name: 'SearchService 搜尋服務',
                        test: () => typeof window.SearchService !== 'undefined'
                    },
                    {
                        name: 'MapService 地圖服務',
                        test: () => typeof window.MapService !== 'undefined'
                    },
                    {
                        name: 'App 主應用程式',
                        test: () => typeof window.App !== 'undefined'
                    }
                ];
                
                results.innerHTML = '';
                
                tests.forEach(test => {
                    const div = document.createElement('div');
                    div.className = 'test-item';
                    
                    try {
                        const success = test.test();
                        if (success) {
                            div.className += ' success';
                            div.innerHTML = `<strong>✅ ${test.name}</strong> - 載入成功`;
                        } else {
                            div.className += ' error';
                            div.innerHTML = `<strong>❌ ${test.name}</strong> - 載入失敗`;
                        }
                    } catch (error) {
                        div.className += ' error';
                        div.innerHTML = `<strong>❌ ${test.name}</strong> - 錯誤: ${error.message}`;
                    }
                    
                    results.appendChild(div);
                });
                
                // 測試服務初始化
                setTimeout(() => {
                    testInitialization();
                }, 500);
            }, 100);
        }
        
        function testInitialization() {
            const results = document.getElementById('test-results');
            
            // 測試無障礙服務初始化
            const accessibilityTest = document.createElement('div');
            accessibilityTest.className = 'test-item';
            
            try {
                if (window.AccessibilityService && typeof window.AccessibilityService.initialize === 'function') {
                    window.AccessibilityService.initialize();
                    accessibilityTest.className += ' success';
                    accessibilityTest.innerHTML = '<strong>✅ AccessibilityService 初始化</strong> - 成功';
                } else {
                    accessibilityTest.className += ' error';
                    accessibilityTest.innerHTML = '<strong>❌ AccessibilityService 初始化</strong> - 方法不存在';
                }
            } catch (error) {
                accessibilityTest.className += ' error';
                accessibilityTest.innerHTML = `<strong>❌ AccessibilityService 初始化</strong> - 錯誤: ${error.message}`;
            }
            
            results.appendChild(accessibilityTest);
            
            // 測試導航服務初始化
            const navigationTest = document.createElement('div');
            navigationTest.className = 'test-item';
            
            try {
                if (window.NavigationService && typeof window.NavigationService.initialize === 'function') {
                    window.NavigationService.initialize();
                    navigationTest.className += ' success';
                    navigationTest.innerHTML = '<strong>✅ NavigationService 初始化</strong> - 成功';
                } else {
                    navigationTest.className += ' error';
                    navigationTest.innerHTML = '<strong>❌ NavigationService 初始化</strong> - 方法不存在';
                }
            } catch (error) {
                navigationTest.className += ' error';
                navigationTest.innerHTML = `<strong>❌ NavigationService 初始化</strong> - 錯誤: ${error.message}`;
            }
            
            results.appendChild(navigationTest);
            
            // 測試搜尋服務初始化
            const searchTest = document.createElement('div');
            searchTest.className = 'test-item';
            
            try {
                if (window.SearchService && typeof window.SearchService.initialize === 'function') {
                    window.SearchService.initialize();
                    searchTest.className += ' success';
                    searchTest.innerHTML = '<strong>✅ SearchService 初始化</strong> - 成功';
                } else {
                    searchTest.className += ' error';
                    searchTest.innerHTML = '<strong>❌ SearchService 初始化</strong> - 方法不存在';
                }
            } catch (error) {
                searchTest.className += ' error';
                searchTest.innerHTML = `<strong>❌ SearchService 初始化</strong> - 錯誤: ${error.message}`;
            }
            
            results.appendChild(searchTest);
            
            // 測試主應用程式初始化
            const appTest = document.createElement('div');
            appTest.className = 'test-item';
            
            try {
                if (window.App && typeof window.App.initialize === 'function') {
                    appTest.className += ' success';
                    appTest.innerHTML = '<strong>✅ App 主應用程式</strong> - 方法存在';
                } else {
                    appTest.className += ' error';
                    appTest.innerHTML = '<strong>❌ App 主應用程式</strong> - 方法不存在';
                }
            } catch (error) {
                appTest.className += ' error';
                appTest.innerHTML = `<strong>❌ App 主應用程式</strong> - 錯誤: ${error.message}`;
            }
            
            results.appendChild(appTest);
            
            // 顯示測試完成訊息
            const completeTest = document.createElement('div');
            completeTest.className = 'test-item info';
            completeTest.innerHTML = '<strong>🎉 測試完成！</strong> 所有服務已檢查完畢。';
            results.appendChild(completeTest);
        }
        
        // 頁面載入完成後開始測試
        window.addEventListener('load', testServices);
    </script>
</body>
</html>